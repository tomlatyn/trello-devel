<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Card Data</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="data-content"></div>
    
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
        var t = window.TrelloPowerUp.iframe();

        // Get all data from all scopes
        t.getAll()
        .then(function (allData) {
            console.log('All data:', JSON.stringify(allData, null, 2));

            var container = document.getElementById('data-content');

            // Display all data
            var allDataHeader = document.createElement('h3');
            allDataHeader.textContent = 'All Data (t.getAll()):';
            container.appendChild(allDataHeader);

            var allDataPre = document.createElement('pre');
            allDataPre.style.whiteSpace = 'pre-wrap';
            allDataPre.style.fontFamily = 'monospace';
            allDataPre.style.fontSize = '12px';
            allDataPre.style.marginBottom = '20px';
            allDataPre.textContent = JSON.stringify(allData, null, 2);
            container.appendChild(allDataPre);

            // Get and display just card shared data
            return t.get('card', 'shared').then(function(cardShared) {
                console.log('Card shared data:', JSON.stringify(cardShared, null, 2));

                var sharedHeader = document.createElement('h3');
                sharedHeader.textContent = 'Card Shared Data (t.get(\'card\', \'shared\')):';
                container.appendChild(sharedHeader);

                var sharedPre = document.createElement('pre');
                sharedPre.style.whiteSpace = 'pre-wrap';
                sharedPre.style.fontFamily = 'monospace';
                sharedPre.style.fontSize = '12px';
                sharedPre.textContent = JSON.stringify(cardShared, null, 2);
                container.appendChild(sharedPre);

                // Display keys
                var keysHeader = document.createElement('h3');
                keysHeader.textContent = 'Available Keys:';
                keysHeader.style.marginTop = '20px';
                container.appendChild(keysHeader);

                var keysList = document.createElement('pre');
                keysList.style.whiteSpace = 'pre-wrap';
                keysList.style.fontFamily = 'monospace';
                keysList.style.fontSize = '12px';
                var keys = cardShared ? Object.keys(cardShared) : [];
                keysList.textContent = JSON.stringify(keys, null, 2);
                container.appendChild(keysList);

                console.log('Available keys:', keys);

                t.sizeTo('body');
            });
        })
        .catch(function(error) {
            console.error('Error loading plugin data:', error);
            document.getElementById('data-content').textContent = 'Error loading plugin data';
        });
    </script>
</body>
</html>